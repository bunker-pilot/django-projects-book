{% extends "base.html" %}
{% load blog_tags %}
{% block page_title %}{{post.title}}{% endblock %}

{% block content %}
<article class="card">
    <img src="{{post.image.url}}" class="post-image">

    <h1>{{post.title}}</h1>

    <p class="meta">
        {{post.published}} · {{post.author}}
    </p>

    <div class="tags">
        {% for tag in post.tags.all %}
            <span>{{tag.name}}</span>
        {% endfor %}
    </div>

    <div style="margin-top:2rem">
        {{post.content|linebreaks}}
    </div>

    <p>
        <a href="{% url "blog:share_post" post.id %}">Share this post</a>
    </p>
</article>

<!-- Similar posts -->
<div class="card">
    <h3>Similar posts</h3>
    {% for p in similar_posts %}
        <p>
            <a href="{{ p.get_absolute_url }}">{{p.title}}</a>
        </p>
    {% empty %}
        <p>No similar posts.</p>
    {% endfor %}
</div>
<!--latest posts-->
<h2> Latest posts:</h2>
{% show_latest_posts 3%}
<!--Most commented posts-->
<h2>Most commented posts</h2>
{% most_commented_posts as most_commented_posts %}
<ul>
    {% for post in most_commented_posts %}
        <li>
            <a href = "{{post.get_absolute_url}}">{{post.title}}</a>
        </li>
    {% endfor %}
</ul>
<!-- Comment form -->
<div class="card">
    <h3>Leave a comment</h3>
    <form method="POST">
        {% csrf_token %}
        {% for field in form %}
            <p>
                {{field.label_tag}}<br>
                {{field}}
            </p>
        {% endfor %}
        <button class="btn" type="submit">Submit</button>
    </form>
</div>
<!-- Comments -->
<div class="card">
    <h3>Comments ({{comments.count}})</h3>

    {% for comment in comments %}
        <p class="meta">
            {{comment.name}} · {{comment.created}}
        </p>
        <p>{{comment.body|linebreaks}}</p>
        <hr>
    {% empty %}
        <p>No comments yet.</p>
    {% endfor %}
</div>


{% endblock %}
